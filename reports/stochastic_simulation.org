
#+TITLE: Stochastic Simulation for Physical Network System
#+AUTHOR: Gun Woo Park

* Re-Defined Stochastic Simulation
The state variable for this system is connectivity map, $\mathscr{C}$, and set of positions for micelle, $\{\mathbf{p}\}$. The time evolution equation for positions is given by Langevin dynamics, and the topological update is following stochastic scheme.

Let started with the time evolution equation for positions:
\begin{equation}
\frac{\partial \mathbf{r}_k}{\partial t} = \frac{1}{\zeta}\left(\sum_{i\in\mathscr{C}_k} \mathbf{F}^{(c)}(\mathbf{r}_i, \mathbf{r}_k) + \sum_i \mathbf{F}^{(r)}(\mathbf{r}_i, \mathbf{r}_k) + \mathbf{F}^{(s)}(\mathbf{r}_k)\right),
\end{equation}
where $\mathbf{F}^{(c)}$ is connection information and $\mathscr{C}_k$ is the chains attached to k-th particle, $\mathbf{F}^{(r)}$ is repulsive potential, and $\mathbf{F}^{(s)}$ and Brownian motion. The forces are given by
\begin{align}
\mathbf{F}^{(c)}(\mathbf{r}_i, \mathbf{r}_k) &= k_BT\frac{N_D}{2}\frac{r_{ik}^2}{R_c^2}\hat{\mathbf{r}}_{ik} \\
\mathbf{F}^{(r)}(\mathbf{r}_i, \mathbf{r}_k) &= -C\frac{k_BT}{R_0}\left(1 - \frac{r_{ik}^2}{R_0^2}\right)\hat{\mathbf{r}}_{ik}.
\end{align}
With Euler integrator, we have
\begin{equation}
\mathbf{r}_k(t + \delta t) = \mathbf{r}_k(t) + \frac{k_BT}{\zeta}\delta t\left[\sum_{i\in \mathscr{C}_k}\frac{N_D}{2}\frac{r_{ik}^2}{R_c^2}\hat{\mathbf{r}}_{ik} - \sum_{i=1}^{N_p} \frac{C}{R_0}\left(1 - \frac{r_{ik}^2}{R_0^2}\right)\hat{\mathbf{r}}_{ik}\right] + \sqrt{\frac{2 k_BT \delta t}{\zeta}}\tilde{\mathbf{R}},
\end{equation}
where $\tilde{\mathbf{R}}\sim \mathscr{N}(0, 1)$.
Since the fastest time scale for this system is given by
\begin{equation}
\tau_B = \frac{R_0^2\zeta}{k_BTC},
\end{equation}
we have non-dimensional form for evolution equation:
\begin{equation}
\tilde{\mathbf{r}}_k(\tilde{t}' + \delta \tilde{t}') = \tilde{\mathbf{r}}_k(\tilde{t}') + \frac{1}{C}\delta\tilde{t}'\sum_{i\in\mathscr{C}_k} \frac{N_D}{2}\alpha\tilde{\mathbf{r}}_{ik} + \delta\tilde{t}'  \sum_{i=1, i\neq k}^{N_p} (\tilde{r}_{ik}^2 - 1)\hat{\mathbf{r}_{ik}} + \sqrt{\frac{2}{C}}\sqrt{\delta \tilde{t}'}\tilde{\mathbf{R}},
\end{equation}
where $\alpha = R_0/R_c$ and prime is used since the characteristic time for the system is given by dissociation time, $\tau_D$. We can re-map to the non-dimensional form based on Brownian time to dissociation time, we have
\begin{equation}
\tilde{\mathbf{r}_k}\left(\tilde{t} + \left(\frac{\tau_B}{\tau_D}\delta \tilde{t}\right)\right) = \tilde{\mathbf{r}_k}(\tilde{t}) + \frac{1}{C}\left(\frac{\tau_B}{\tau_D}\delta \tilde{t}\right) \sum_{i\in\mathscr{C}_k} \frac{N_D}{2}\alpha \tilde{\mathbf{r}}_{ik} + \left(\frac{\tau_B}{\tau_D}\delta\tilde{t}\right)\sum_{i=1,i\neq k}^{N_p}(\tilde{\mathbf{r}}_{ik}^2 - 1)\hat{\mathbf{r}}_{ik} + \sqrt{\frac{2}{C}}\sqrt{\frac{\tau_B}{\tau_D}\delta \tilde{t}}\tilde{\mathbf{R}}.
\end{equation}
The topological information will be updated whenever $\delta\tilde{t}$, which means when number of Brownian update reaches rational time,
\begin{equation}
R_t = \frac{\tau_D}{\tau_B},
\end{equation}
the topology will be updated.

* Topology Update
Let define the detachment frequency for the chain as
\begin{equation}
\beta = \beta_0\exp\left(\frac{Fl}{k_BT}\right),
\end{equation}
where $\beta_0$ is detachment frequency for loop chain: $\exp(E/k_BT)$.
In each $R_t$ steps for Brownian update, the topology is subject to update. For given interval of time, $\Delta t$, the expected value for number of detachment becomes 
\begin{equation}
N^\dagger = N_{tot}\bar{\beta}\Delta t,
\end{equation}
where $\bar{\beta}$ is number average for the detachment frequency:
\begin{equation}
\bar{\beta} = \frac{1}{N_{tot}} \sum_{i=1}^{N_{tot}}\beta_i.
\end{equation}

On each $\Delta t$, we select random chain ends in $N_{tot}$ times. When the selected chain ends 


# Since the system characteristic time is given by dissociation time, $\tau_D(>\tau_B)$, we can re-map the given non-dimenional form into the characteristic time
# \begin{equation}
# \tilde{\mathbf{r}}_k(\tilde{t} + \delta \tilde{t}) = \tilde{\mathbf{r}}_k(\tilde{t}) + \frac{1}{C}\delta\tilde{t}\sum_{i\in\mathscr{C}_k} \frac{N_D}{2}\alpha\tilde{\mathbf{r}}_{ik} + \delta\tilde{t}  \sum_{i=1, i\neq k}^{N_p} (\tilde{r}_{ik}^2 - 1)\hat{\mathbf{r}_{ik}} + \sqrt{\frac{2}{C}}\sqrt{\delta \tilde{t}}\tilde{\mathbf{R}},
# \end{equation}



# The system characteristic time is given by dissociation time, $\tau_D$ with $\tau_D > \tau_B$. The evolution equation can be expressed by
# \begin{equation}
# \tilde{\mathbf{r}}_k(\tilde{t} + \delta \tilde{t}) = \tilde{\mathbf{r}}_k(\tilde{t}) + \frac{\tau_D}{\tau_C C}\delta\tilde{t}\sum_{i\in\mathscr{C}_k} \frac{N_D}{2}\alpha\tilde{\mathbf{r}}_{ik} + \frac{\tau_D}{\tau_C}\delta\tilde{t}  \sum_{i=1, i\neq k}^{N_p} (\tilde{r}_{ik}^2 - 1)\hat{\mathbf{r}_{ik}} + \sqrt{\frac{\tau_D}{\tau_C}}\sqrt{\delta \tilde{t}}\tilde{\mathbf{r}},
# \end{equation}


# Let characteristic time as dissociation time, $\tau_D$ with $\tau_D > \tau_B$, the Brownian update is based on
# , the given non-dimensional form for the evolution equation becomes
# \begin{equation}
# \tilde{\mathbf{r}}_k(\tilde{t} + \delta \tilde{t}) = \tilde{\mathbf{r}}_k(\tilde{t}) + \frac{k_BT\tau_D}{R_0^2\zeta}\delta\tilde{t}\sum_{i\in\mathscr{C}_k} \frac{N_D}{2}\alpha\tilde{\mathbf{r}}_{ik} + \frac{k_BTC\tau_D}{R_0^2 \zeta}\delta\tilde{t}  \sum_{i=1, i\neq k}^{N_p} (\tilde{r}_{ik}^2 - 1)\hat{\mathbf{r}_{ik}} + \sqrt{\frac{2k_BT\tau_D}{R_0^2\zeta}}\sqrt{\delta \tilde{t}}\tilde{\mathbf{r}},
# \end{equation}

# If we define Brownian time step, $\tau_B$:
# \begin{equation}
# \tau_B = \frac{R_0^2\zeta}{k_BT C},
# \end{equation}
# the $\tau_B$ is much shorter than the $\tau_D$, and the ratio is arbitrary value at this moment. On this regards, we can express the evolution equation based on Brownian time update


# Let $\tau_D$ be dissociation time and $\tau_B$ is Brownian update time scale which is given by
# \begin{equation}
# \tau_B = \frac{R_0^2\zeta}{k_BT C},
# \end{equation}
# the time step to update should be based on $\tau_B$. Let characteristic time step as $\tau_

# Because of $\tau_D > \tau_B$, the dimenionless time step for Brownian motion follows that time step:
# \begin{equation}
# \delta\tilde{t}_B = \frac{\delta\tilde{t}}{\tau_D/\tau_B} = \frac{\tau_B\delta\tilde{t}}{\tau_D}.
# \end{equation}
# In this case, the increment time step becomes
# \begin{equation}
# \delta t = \tau_D \delta \tilde_{t}
# \end{equation}

# where $\alpha = R_0/R_c$. For simplification, let integrator time scale:
# \begin{equation}
# \tau_I = \frac{R_0^2\zeta}{k_BT C},
# \end{equation}
# we have
# \begin{equation}
# \tilde{\mathbf{r}}_k(\tilde{t} + \delta \tilde{t}) = \tilde{\mathbf{r}}_k(\tilde{t}) + \frac{\tau_D}{\tau_C C}\delta\tilde{t}\sum_{i\in\mathscr{C}_k} \frac{N_D}{2}\alpha\tilde{\mathbf{r}}_{ik} + \frac{\tau_D}{\tau_C}\delta\tilde{t}  \sum_{i=1, i\neq k}^{N_p} (\tilde{r}_{ik}^2 - 1)\hat{\mathbf{r}_{ik}} + \sqrt{\frac{\tau_D}{\tau_C}}\sqrt{\delta \tilde{t}}\tilde{\mathbf{r}},
# \end{equation}

# The characteristic length is given by micelle dimension, $R_0$, and the time scale for the 


# The Euler integrator for the given evolution equation is given by
# \begin{equation}
# \mathbf{r}_k(t+\delta t) = 
# \end{equation}

# the characteristic length scale for the system is given by micelle dimension, $R_0$, and the time scale is dissociation time, $\tau_D$. 

# Let $\tau_B$ be the Brownian time steps and $\tau_D$ be dissociation time step:
# \begin{equation}
# \tau_B = \frac{\zeta R_0^2}{k_BT C},
# \end{equation}
# where $\zeta$ is friction coefficient for micelle, R_0 is micelle dimension which is characteristic length for the system, and $C$ is repulsive coefficient.
# Consider the 


# The given evolution equation for the previous set is described on
# \begin{equation}
# \frac{\partial \mathbf{r}_k}{\partial t} = \frac{1}{\zeta}\left(\sum_{i\in\mathscr{C}_k} \mathbf{F}^{(c)}(\mathbf{r}_i, \mathbf{r}_k) + \sum_i \mathbf{F}^{(r)}(\mathbf{r}_i, \mathbf{r}_k) + \mathbf{F}^{(s)}(\mathbf{r}_k)\right),
# \end{equation}
# where the information for $\mathscr{C}_k$ for all k in $[0, N_p]$ is already measured during stochastic steps.

# In this case, we can think that the time is passing during Brownian update while the stochastic step can be regarded infinite for each Brownian update.

# Since the equation evolve Brownian time, we can choose the characteristic time step as
# \begin{equation}
# t_c = \frac{\zeta}{k_BT}R_0^2,
# \end{equation}
# where $R_0$ is micell dimension with the characteristic length:
# \begin{equation}
# r_c = R_0.
# \end{equation}

# \begin{equation}
# \tilde{\mathbf{r}}_k(\tilde{t} + \delta \tilde{t}) = \tilde{\mathbf{r}}_k(\tilde{t}) + \sum_{i\in\mathscr{C}_k}\tilde{\mathbf{F}}^{(c)}(\tilde{\mathbf{r}}_i, \tilde{\mathbf{r}}_k) + \sum_{i}\tilde{\mathbf{F}}^{(r)}(\tilde{\mathbf{r}}_i, \tilde{\mathbf{r}}_k)\delta \tilde{t} + \tilde{\mathbf{F}}^{(s)}_k\sqrt{\delta\tilde{t}},
# \end{equation}

# \begin{align}
# \tilde{\mathbf{F}}^{(r)}(\tilde{\mathbf{r}}_i, \tilde{\mathbf{r}}_j) &= -\left(1-\tilde{\mathbf{r}}_{ij}^2\right)\frac{\tilde{\mathbf{r}}_{ij}}{\tilde{r}_{ij}}\\
# \tilde{\mathbf{F}}^{(s)} &= \sqrt{\frac{2}{3}}\tilde{\mathbf{R}}
# \end{align}

# \begin{align}
#   \tilde{U}^{(c)}(\tilde{\mathbf{r}}_{ij}) &= \frac{N_D}{2}\tilde{\mathbf{r}}_{ij}^2,\\
#   \tilde{\mathbf{F}}^{(c)}(\tilde{\mathbf{r}}_{ij}) &= N_D\tilde{\mathbf{r}}_{ij}.
# \end{align}

# \begin{equation}
# w(\delta t, \tau) = 1 - \exp\left(-\frac{\delta t}{\tau}\right)
# \end{equation}

# \begin{equation}
# P_{ik} = \frac{\exp(-\tilde{u}_{ik})}{\sum_{j}\exp(-\tilde{u}_{jk})}
# \end{equation}





* Modification
If it is not the case, 
